<button
  type="button"
  class="btn btn-annoucement"
  data-toggle="modal"
  data-target="#announcementModal"
>
  <ion-icon name="add-circle"></ion-icon>
  Duyuru Ekle
</button>

<div
  class="modal fade"
  id="announcementModal"
  tabindex="-1"
  role="dialog"
  aria-labelledby="announcementModalLabel"
  aria-hidden="true"
>
  <div class="modal-dialog" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="announcementModalLabel">Duyuru Ekle</h5>
        <button
          type="button"
          class="close"
          data-dismiss="modal"
          aria-label="Close"
        >
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        <form id="announcementForm">
          <div class="form-group">
            <label for="announcementTitle">Başlık</label>
            <input
              type="text"
              class="form-control"
              id="announcementTitle"
              required
            />
          </div>
          <div class="form-group">
            <label for="announcementContent">Duyuru İçeriği</label>
            <textarea
              class="form-control"
              id="announcementContent"
              rows="4"
              required
            ></textarea>
          </div>
          <div class="form-group">
            <label for="announcementCategory">Kategori</label>
            <input
              type="text"
              class="form-control"
              id="announcementCategory"
              required
            />
          </div>
          <div class="form-group">
            <label for="expirationDate">Son Geçerlilik Tarihi</label>
            <input
              type="datetime-local"
              class="form-control"
              id="expirationDate"
              required
            />
          </div>
        </form>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-dismiss="modal">
          Kapat
        </button>
        <button type="button" class="btn btn-primary" id="submitAnnouncement">
          Ekle
        </button>
      </div>
    </div>
  </div>
</div>

<script>
  $(document).ready(function () {
    $("#submitAnnouncement").on("click", function () {
      const title = $("#announcementTitle").val();
      const content = $("#announcementContent").val();
      const category = $("#announcementCategory").val();
      const expirationDate = $("#expirationDate").val();

      if (title && content && category && expirationDate) {
        $.ajax({
          type: "POST",
          url: "/announcements",
          data: {
            title: title,
            content: content,
            category: category,
            expiration_date: expirationDate,
          },
          success: function (response) {
            $("#announcementModal").modal("hide");
            $("#announcementForm")[0].reset();
          },
          error: function (err) {
            alert("Duyuru ekleme sırasında bir hata oluştu.");
          },
        });
      } else {
        alert("Lütfen tüm alanları doldurun.");
      }
    });
  });
</script>
